<div class="page-header">
  <h1 class ='text-center'>Reports</h1>
</div>

<div class="page-header col-xs-12">
  <div class = 'row'>

    <div class="form-group col-xs-12 col-sm-3">
      <h5>Report Type</h5>
      <div class="radio">
        <label>
          <input ng-model='report.reportType'  type="radio" name="reportType" value='manager' ng-checked>
          Manager Report (Explanation)
        </label>
      </div>
      <div class="radio">
        <label>
          <input ng-model='report.reportType'  type="radio" name="reportType" value='worker'>
          Services by Worker
        </label>
      </div>
      <div class="radio">
        <label>
          <input ng-model='report.reportType'  type="radio" name="reportType" value='property'>
          Services by Property
        </label>
      </div>
    </div>
    <div class="form-group col-xs-12 col-sm-4" ng-show='report.reportType'>
      <h5>Pick Start-End Date</h5>
      <div class="col-xs-12">
        <label for="jobSearchStart" class="control-label">From</label>
          <input required ng-model="report.date.start" type="date" class="form-control" id="jobSearchStart"  format-date>
        </div>
        <div class="col-xs-12">
        <label for="jobSearchEnd" class='control-label'>To</label>
          <input required ng-model="report.date.end" type="date" class="form-control" id="jobSearchEnd" format-date>
      </div>
    </div>
    <div class='col-xs-12 col-sm-4' ng-show ='report.reportType'>
      
      <h5>Select Field</h5>
      <div class="form-group text-center" ng-if = 'report.reportType==="manager"'>
        <label for="reportManagerFilter" class="col-xs-2 control-label">Manager</label>
        <div>
          <select ng-model = 'report.manager' class="form-control" id='reportManagerFilter'>
            <option  value = '{{admin._id}}' ng-repeat ='admin in admins'>
            {{admin.first}} {{admin.last}}
            </option>
          </select>
        </div>
      </div>
      <div class="form-group text-center" ng-if = 'report.reportType==="worker"'>
        <label for="reportWorkerFilter" class="col-xs-2 control-label">Worker</label>
        <div>
          <select ng-change='clearFilter()' ng-model = 'report.worker' class="form-control" id='reportWorkerFilter'>
            <option value =''>All</option>
            <option  value = '{{worker._id}}' ng-repeat ='worker in workers'>
            {{worker.first}} {{worker.last}}
            </option>
          </select>
        </div>
      </div>
    
      <div class="form-group text-center" ng-if = 'report.reportType==="property"'>
        <label for="reportPropertyFilter" class="col-xs-2 control-label">Property</label>
        <div>
          <select ng-model = 'report.propertie' class="form-control" id='reportPropertyFilter'>
            <option value =''>All</option>
            <option  value = '{{property._id}}' ng-repeat ='property in properties'>
            {{property.name}}
            </option>
          </select>
        </div>
      </div>   
    </div>
  </div><br>
  <div class='col-xs-12'>
    <button class="btn btn-default center-block" type="button" ng-click='generateReport()'><i class="fa fa-plus-circle"></i> Generate Report</button>
  </div>
</div>

<div class="panel panel-default">
  <table class="table table-bordered table table-striped">
    <tr>
      <th>Property</th>
      <th>Apt#</th>   
      <th>Services</th>
      <!-- <th>Description</th>
      <th>Worker</th>
      <th>Price</th>
      <th>Assigned Date</th> -->
      <th>PO #</th>
      <th>Invoice #</th>
      <th>Edit</th>
    </tr>
    <tr ng-repeat = 'job in report.jobs'>
      <td>{{job.propertie.name}}</td>
      <td>{{job.unit}}</td>
      <td>
        
        <div ng-repeat = 'service in job.services'>          
          <p ng-show ='service.date_assigned>=startDateCompare && service.date_assigned<=endDateCompare'>
          {{service.item}}
          {{service.date_assigned}}
          {{service.worker.first}} {{service.worker.last}}
          {{service.descrition}}
          {{service.price}}
          </p>
        </div>
      </td>
      <td>{{job.poNumber}}</td>
      <td>{{job.invoiceNumber}}</td>
      <td>edit</td>
    </tr>
  </table>
</div>
